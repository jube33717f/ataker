{"ast":null,"code":"var _jsxFileName = \"/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/leave-review/leave-review.js\";\nimport React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport BlurBackgroundHoc from \"../../hoc/blurBackgroundHoc\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faWindowClose } from \"@fortawesome/free-solid-svg-icons\";\nimport { connect } from \"react-redux\";\nimport { deleteLastSubPath } from \"../../utils/path-generator\";\nimport { reloadTaskDetail } from \"../../redux/actions\";\nimport { reqUpdateUser, reqUserInfo } from \"../../api/api\";\nimport \"./leave-review.scss\";\nimport Rating from \"../../components/rating/rating\"; // TODO @SONIA\n\nconst {\n  BASE\n} = global.constants;\n\nclass LeaveReview extends React.Component {\n  constructor() {\n    super();\n\n    this.sendReview = async () => {\n      const {\n        pathname\n      } = this.props.location;\n\n      try {\n        const userResult = await reqUserInfo(this.props.user.email);\n        const updateUserResult = await reqUpdateUser(this.props.user.email, {\n          rating: this.state.rating + userResult.rating / 2\n        }); ////这里后台数据结构要改\n\n        if (updateUserResult.status === 200) {\n          this.props.reloadTaskDetail(true);\n          this.props.history.push(deleteLastSubPath(pathname));\n        }\n      } catch (e) {\n        alert('Failed to post a review');\n      }\n    };\n\n    this.state = {\n      rating: 5\n    };\n  }\n\n  componentDidMount() {\n    this.props.blurBackground();\n  }\n\n  componentWillUnmount() {\n    this.props.resetBackground();\n  }\n\n  render() {\n    const {\n      pathname\n    } = this.props.location;\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container--not-blured\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"leave-review-form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form__header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, \"Review\", React.createElement(FontAwesomeIcon, {\n      icon: faWindowClose,\n      className: \"button-close\",\n      onClick: () => {\n        this.props.history.push(deleteLastSubPath(pathname));\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"auth-form__content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, React.createElement(Rating, {\n      onClick: e => this.setState({\n        rating: e.target.value\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"bottom-buttons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: this.sendReply,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, \"Send\")))));\n  }\n\n}\n\nexport default connect(state => ({\n  user: state.user\n}), {\n  reloadTaskDetail\n})(BlurBackgroundHoc(withRouter(LeaveReview)));","map":{"version":3,"sources":["/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/leave-review/leave-review.js"],"names":["React","Link","withRouter","BlurBackgroundHoc","FontAwesomeIcon","faWindowClose","connect","deleteLastSubPath","reloadTaskDetail","reqUpdateUser","reqUserInfo","Rating","BASE","global","constants","LeaveReview","Component","constructor","sendReview","pathname","props","location","userResult","user","email","updateUserResult","rating","state","status","history","push","e","alert","componentDidMount","blurBackground","componentWillUnmount","resetBackground","render","setState","target","value","sendReply"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link, withRouter } from \"react-router-dom\";\nimport BlurBackgroundHoc from \"../../hoc/blurBackgroundHoc\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faWindowClose } from \"@fortawesome/free-solid-svg-icons\";\nimport { connect } from \"react-redux\";\nimport { deleteLastSubPath } from \"../../utils/path-generator\"\nimport { reloadTaskDetail } from \"../../redux/actions\"\nimport { reqUpdateUser, reqUserInfo } from \"../../api/api\"\nimport \"./leave-review.scss\"\nimport Rating from \"../../components/rating/rating\"\n\n// TODO @SONIA\nconst { BASE } = global.constants;\n\nclass LeaveReview extends React.Component {\n    constructor() {\n        super();\n        this.state = {\n            rating: 5\n        }\n    }\n\n\n    componentDidMount() {\n        this.props.blurBackground();\n    }\n\n    componentWillUnmount() {\n        this.props.resetBackground();\n    }\n\n    sendReview = async () => {\n        const { pathname } = this.props.location;\n\n        try {\n            const userResult = await reqUserInfo(this.props.user.email);\n            const updateUserResult = await reqUpdateUser(this.props.user.email, { rating: this.state.rating + userResult.rating / 2 }); ////这里后台数据结构要改\n            if (updateUserResult.status === 200) {\n                this.props.reloadTaskDetail(true);\n                this.props.history.push(deleteLastSubPath(pathname))\n            }\n        } catch (e) {\n            alert('Failed to post a review')\n        }\n    }\n\n\n    render() {\n        const { pathname } = this.props.location;\n        return (\n            <div className=\"container\">\n                <div className=\"container--not-blured\">\n                    <div className=\"leave-review-form\">\n                        <div className=\"form__header\">\n                            <div>\n                                Review\n                                    <FontAwesomeIcon icon={faWindowClose} className=\"button-close\"\n                                    onClick={() => {\n                                        this.props.history.push(deleteLastSubPath(pathname))\n                                    }} />\n                            </div>\n                        </div>\n\n                        <div className=\"auth-form__content\">\n\n                            <Rating onClick={(e) => this.setState({ rating: e.target.value })} />\n                        </div>\n\n                        <div className=\"bottom-buttons\">\n                            <button\n                                onClick={this.sendReply}>\n                                Send\n                        </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n}\nexport default connect(state => ({ user: state.user }), { reloadTaskDetail })(\n    BlurBackgroundHoc(withRouter(LeaveReview))\n);\n"]},"metadata":{},"sourceType":"module"}