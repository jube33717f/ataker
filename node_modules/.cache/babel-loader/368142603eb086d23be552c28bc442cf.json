{"ast":null,"code":"var _jsxFileName = \"/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-left/browse-tasks-left.js\";\nimport React, { Component } from \"react\";\nimport \"./browse-tasks-left.scss\";\nimport { connect } from \"react-redux\";\nimport { Route, withRouter, Link } from \"react-router-dom\";\nimport { reqTaskList } from \"../../../api/api\";\nimport formatDate from \"../../../utils/date-formatter\";\nimport { reloadTaskList, addTaskList } from \"../../../redux/actions\"; // TODO @JUBI\n\nclass BrowseTasksLeft extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentIndex: -1,\n      newsShow: false,\n      newsNum: this.props.taskList.listData.length //itemShow:false\n\n    };\n    this.setCurrentIndex = this.setCurrentIndex.bind(this);\n    this.refresh = this.refresh.bind(this);\n  }\n\n  setCurrentIndex(event) {\n    // console.log('a')\n    this.setState({\n      currentIndex: parseInt(event.currentTarget.getAttribute('indexc'), 10) // console.log(currentIndex)\n\n    }); // console.log(this.state.currentIndex)\n  }\n\n  refresh() {\n    // console.log('a')\n    if (this.props.taskList.listData && this.props.taskList.listData.length > 0) {\n      this.setState({\n        newsShow: false,\n        newsNum: this.props.taskList.listData.length\n      });\n    }\n\n    this.forceUpdate();\n  } //SONIA:\n\n\n  generatePath(item) {\n    return `${item.title.replace(/ /g, \"-\")}-${item._id}`;\n  } ////\n\n\n  generateStatus(status) {\n    if (status === \"assigned-topay\") {\n      return \"assigned\";\n    } else {\n      return status;\n    }\n  }\n\n  async componentDidMount() {\n    try {\n      const result = await reqTaskList();\n\n      if (result.status === 200) {\n        this.props.addTaskList(result.data.taskList);\n        this.setState({\n          newsNum: result.data.taskList.length\n        });\n      }\n    } catch (error) {\n      alert(\"failed to request task list\");\n    }\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (JSON.stringify(this.props) != JSON.stringify(prevProps)) {\n      if (this.props.taskList.readyToReload) {\n        try {\n          const result = await reqTaskList();\n\n          if (result.status === 200) {\n            this.props.addTaskList(result.data.taskList);\n            this.setState({\n              newsShow: true,\n              newsNum: result.data.taskList.length - this.state.newsNum\n            });\n          }\n        } catch (error) {\n          alert(\"failed to request task list\");\n        }\n\n        this.props.reloadTaskList(false);\n      }\n    } // console.log(prevProps.price)\n    // if(this.props.price!==prevProps.price){\n    //     this.forceUpdate();\n    // }\n\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"task__list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, this.state.newsShow && React.createElement(\"div\", {\n      onClick: this.refresh,\n      className: \"task__list--newlist--loadmore--frame\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"task__list--newlist--loadmore\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newlist--loadmore--count\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, this.state.newsNum, \" \"), React.createElement(\"span\", {\n      className: \"newlist--loadmore--message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, \" new task\", this.state.newsNum < 2 ? '' : 's'))), React.createElement(\"div\", {\n      className: \"loaderific--not--loading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"list vertical--scroll\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, this.props.price.length !== 0 ? this.props.taskList.listData.filter(data => data.price - 0 > this.props.price[0] && data.price - 0 < this.props.price[1]).sort((a, b) => Date.parse(b.postDate) - Date.parse(a.postDate)).map((item, index) => // SONIA：把下一行原来的<a>换成了div+onclick事件，这样可以通过react router跳转到下个页面\n    //this.state.currentIndex === index ? 'newtask__list--item--open' : ''\n    //   <a key={index} className=\"newtask__list--item newtask__list--item--open\">\n    React.createElement(\"div\", {\n      key: index,\n      className: ['newtask__list--item', 'newtask__list--item--open', this.state.currentIndex === index ? 'newtask__list--item--open--style' : ''].join(' ') //jubi\n      ,\n      indexc: index,\n      onMouseDown: this.setCurrentIndex,\n      onClick: () => {\n        this.props.history.push(`${this.props.match.path}/${this.generatePath(item)}`);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"newtask__list--item--header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newtask__list--item--header--title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, item.title), React.createElement(\"div\", {\n      className: \"newtask__list--item--header--price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"$\", item.price))), React.createElement(\"div\", {\n      className: \"newtask__list--item--body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"avatar__img newtask__list--item--body--avatar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: item.photo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"newtask__list--item--avatar--online\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newtask__list--item--avatar--online--detail\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, item.place)), React.createElement(\"div\", {\n      className: \"newtask__list--item--dateat--icon--calendar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newtask__list--item--dateat--icon--calendar--detail\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, formatDate(item.dueDate)))), React.createElement(\"div\", {\n      className: \"newtask__list--item--footer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newtask__list--item--footer--status\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, this.generateStatus(item.status)), React.createElement(\"span\", {\n      className: \"newtask__list--item--footer--bids\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, item.offers ? `${item.offers.length} offer${item.offers.length > 1 ? 's' : ''}` : `0 offer`)))) : this.props.taskList.listData.sort((a, b) => Date.parse(b.postDate) - Date.parse(a.postDate)).map((item, index) => // SONIA：把下一行原来的<a>换成了div+onclick事件，这样可以通过react router跳转到下个页面\n    //this.state.currentIndex === index ? 'newtask__list--item--open' : ''\n    //   <a key={index} className=\"newtask__list--item newtask__list--item--open\">\n    React.createElement(\"div\", {\n      key: index,\n      className: ['newtask__list--item', 'newtask__list--item--open', this.state.currentIndex === index ? 'newtask__list--item--open--style' : ''].join(' ') //jubi\n      ,\n      indexc: index,\n      onMouseDown: this.setCurrentIndex,\n      onClick: () => {\n        this.props.history.push(`${this.props.match.path}/${this.generatePath(item)}`);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"newtask__list--item--header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newtask__list--item--header--title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, item.title), React.createElement(\"div\", {\n      className: \"newtask__list--item--header--price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, \"$\", item.price))), React.createElement(\"div\", {\n      className: \"newtask__list--item--body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"avatar__img newtask__list--item--body--avatar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: item.photo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"newtask__list--item--avatar--online\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newtask__list--item--avatar--online--detail\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, item.place)), React.createElement(\"div\", {\n      className: \"newtask__list--item--dateat--icon--calendar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newtask__list--item--dateat--icon--calendar--detail\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, formatDate(item.dueDate)))), React.createElement(\"div\", {\n      className: \"newtask__list--item--footer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"newtask__list--item--footer--status\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, item.status), React.createElement(\"span\", {\n      className: \"newtask__list--item--footer--bids\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, item.offers ? `${item.offers.length} offer${item.offers.length > 1 ? 's' : ''}` : `0 offer`))))), React.createElement(\"div\", {\n      className: \"newtask__list--loading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"loaderific--not--loading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default connect(state => ({\n  taskList: state.taskList,\n  price: state.price.price\n}), {\n  addTaskList,\n  reloadTaskList\n})(withRouter(BrowseTasksLeft));","map":{"version":3,"sources":["/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-left/browse-tasks-left.js"],"names":["React","Component","connect","Route","withRouter","Link","reqTaskList","formatDate","reloadTaskList","addTaskList","BrowseTasksLeft","constructor","props","state","currentIndex","newsShow","newsNum","taskList","listData","length","setCurrentIndex","bind","refresh","event","setState","parseInt","currentTarget","getAttribute","forceUpdate","generatePath","item","title","replace","_id","generateStatus","status","componentDidMount","result","data","error","alert","componentDidUpdate","prevProps","prevState","JSON","stringify","readyToReload","render","price","filter","sort","a","b","Date","parse","postDate","map","index","join","history","push","match","path","photo","place","dueDate","offers"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./browse-tasks-left.scss\";\nimport { connect } from \"react-redux\";\nimport { Route, withRouter, Link } from \"react-router-dom\";\nimport { reqTaskList } from \"../../../api/api\";\nimport formatDate from \"../../../utils/date-formatter\";\nimport { reloadTaskList, addTaskList } from \"../../../redux/actions\"\n\n// TODO @JUBI\nclass BrowseTasksLeft extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentIndex: -1,\n      newsShow: false,\n      newsNum: this.props.taskList.listData.length,\n      //itemShow:false\n    };\n    this.setCurrentIndex = this.setCurrentIndex.bind(this);\n    this.refresh = this.refresh.bind(this);\n  }\n  setCurrentIndex(event) {\n    // console.log('a')\n    this.setState({\n      currentIndex: parseInt(event.currentTarget.getAttribute('indexc'), 10)\n      // console.log(currentIndex)\n    })\n    // console.log(this.state.currentIndex)\n  }\n  refresh() {\n    // console.log('a')\n    if (this.props.taskList.listData && this.props.taskList.listData.length > 0) {\n      this.setState({ newsShow: false, newsNum: this.props.taskList.listData.length });\n    }\n    this.forceUpdate();\n  }\n\n  //SONIA:\n  generatePath(item) {\n    return `${item.title.replace(\n      / /g,\n      \"-\"\n    )}-${item._id}`;\n  }\n\n  ////\n  generateStatus(status) {\n    if (status === \"assigned-topay\") {\n      return \"assigned\"\n    } else {\n      return status\n    }\n  }\n\n  async componentDidMount() {\n    try {\n      const result = await reqTaskList();\n      if (result.status === 200) {\n        this.props.addTaskList(result.data.taskList);\n        this.setState({ newsNum: result.data.taskList.length });\n      }\n    } catch (error) {\n      alert(\"failed to request task list\");\n    }\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (JSON.stringify(this.props) != JSON.stringify(prevProps)) {\n      if (this.props.taskList.readyToReload) {\n        try {\n          const result = await reqTaskList();\n          if (result.status === 200) {\n            this.props.addTaskList(result.data.taskList);\n            this.setState({ newsShow: true, newsNum: result.data.taskList.length - this.state.newsNum })\n          }\n        } catch (error) {\n          alert(\"failed to request task list\");\n        }\n        this.props.reloadTaskList(false)\n      }\n    }\n    // console.log(prevProps.price)\n    // if(this.props.price!==prevProps.price){\n\n    //     this.forceUpdate();\n    // }\n  }\n\n  render() {\n\n    return (\n      <div className=\"task__list\">\n        {this.state.newsShow && (<div onClick={this.refresh} className=\"task__list--newlist--loadmore--frame\">\n          <div className=\"task__list--newlist--loadmore\">\n            <span className=\"newlist--loadmore--count\" >{this.state.newsNum} </span>\n            <span className=\"newlist--loadmore--message\"> new task{this.state.newsNum < 2 ? '' : 's'}</span>\n          </div>\n        </div>)}\n\n        <div className=\"loaderific--not--loading\"></div>\n\n        <div className=\"list vertical--scroll\">\n          <div className=\"group\">\n            {/* {this.props.price===[]?'':''} */}\n            {/* this.props.price===[]? */}\n            {this.props.price.length !== 0 ? (this.props.taskList.listData.filter(data => data.price - 0 > this.props.price[0] && data.price - 0 < this.props.price[1]).sort((a, b) => Date.parse(b.postDate) - Date.parse(a.postDate))\n              .map((item, index) => (\n                // SONIA：把下一行原来的<a>换成了div+onclick事件，这样可以通过react router跳转到下个页面\n                //this.state.currentIndex === index ? 'newtask__list--item--open' : ''\n                //   <a key={index} className=\"newtask__list--item newtask__list--item--open\">\n\n                <div\n                  key={index}\n                  className={['newtask__list--item', 'newtask__list--item--open', this.state.currentIndex === index ? 'newtask__list--item--open--style' : ''].join(' ')}//jubi\n                  indexc={index}\n                  onMouseDown={this.setCurrentIndex}\n                  onClick={() => {\n                    this.props.history.push(\n                      `${this.props.match.path}/${this.generatePath(item)}`\n                    );\n\n                  }}\n                >\n                  <div className=\"newtask__list--item--header\">\n                    <span className=\"newtask__list--item--header--title\">\n                      {item.title}\n                    </span>\n                    <div className=\"newtask__list--item--header--price\">\n                      <span>${item.price}</span>\n                    </div>\n                  </div>\n                  <div className=\"newtask__list--item--body\">\n                    <div className=\"avatar__img newtask__list--item--body--avatar\">\n                      <img src={item.photo} />\n                    </div>\n                    <div className=\"newtask__list--item--avatar--online\">\n                      <span className=\"newtask__list--item--avatar--online--detail\">\n                        {item.place}\n                      </span>\n                    </div>\n                    <div className=\"newtask__list--item--dateat--icon--calendar\">\n                      <span className=\"newtask__list--item--dateat--icon--calendar--detail\">\n                        {formatDate(item.dueDate)}\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"newtask__list--item--footer\">\n                    <span className=\"newtask__list--item--footer--status\">\n                      {this.generateStatus(item.status)}\n                    </span>\n                    <span className=\"newtask__list--item--footer--bids\">\n                      {/* SONIA: */}\n                      {item.offers ? `${item.offers.length} offer${item.offers.length > 1 ? 's' : ''}` : `0 offer`}\n                    </span>\n                  </div>\n                  {/* </a> */}\n                </div>\n              ))) :\n              (this.props.taskList.listData.sort((a, b) => Date.parse(b.postDate) - Date.parse(a.postDate)).map((item, index) => (\n                // SONIA：把下一行原来的<a>换成了div+onclick事件，这样可以通过react router跳转到下个页面\n                //this.state.currentIndex === index ? 'newtask__list--item--open' : ''\n                //   <a key={index} className=\"newtask__list--item newtask__list--item--open\">\n\n                <div\n                  key={index}\n                  className={['newtask__list--item', 'newtask__list--item--open', this.state.currentIndex === index ? 'newtask__list--item--open--style' : ''].join(' ')}//jubi\n                  indexc={index}\n                  onMouseDown={this.setCurrentIndex}\n                  onClick={() => {\n                    this.props.history.push(\n                      `${this.props.match.path}/${this.generatePath(item)}`\n                    );\n\n                  }}\n                >\n                  <div className=\"newtask__list--item--header\">\n                    <span className=\"newtask__list--item--header--title\">\n                      {item.title}\n                    </span>\n                    <div className=\"newtask__list--item--header--price\">\n                      <span>${item.price}</span>\n                    </div>\n                  </div>\n                  <div className=\"newtask__list--item--body\">\n                    <div className=\"avatar__img newtask__list--item--body--avatar\">\n                      <img src={item.photo} />\n                    </div>\n                    <div className=\"newtask__list--item--avatar--online\">\n                      <span className=\"newtask__list--item--avatar--online--detail\">\n                        {item.place}\n                      </span>\n                    </div>\n                    <div className=\"newtask__list--item--dateat--icon--calendar\">\n                      <span className=\"newtask__list--item--dateat--icon--calendar--detail\">\n                        {formatDate(item.dueDate)}\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"newtask__list--item--footer\">\n                    <span className=\"newtask__list--item--footer--status\">\n                      {item.status}\n                    </span>\n                    <span className=\"newtask__list--item--footer--bids\">\n                      {/* SONIA: */}\n                      {item.offers ? `${item.offers.length} offer${item.offers.length > 1 ? 's' : ''}` : `0 offer`}\n                    </span>\n                  </div>\n                  {/* </a> */}\n                </div>\n              )))}\n\n          </div>\n\n          <div className=\"newtask__list--loading\">\n            <div className=\"loaderific--not--loading\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\nexport default connect(state => ({ taskList: state.taskList, price: state.price.price }), { addTaskList, reloadTaskList })(\n  withRouter(BrowseTasksLeft)\n);"]},"metadata":{},"sourceType":"module"}