{"ast":null,"code":"var _jsxFileName = \"/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-right/task-detail/task-detail.js\";\nimport React, { Component } from \"react\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport SideBar from \"./side-bar/side-bar\";\nimport LeftPanel from \"./left-panel/left-panel\";\nimport OfferSection from \"./offer-section/offer-section\";\nimport QuestionSection from \"./question-section/question-section\";\nimport { reqTaskDetail } from \"../../../../api/api\";\nimport \"./task-detail.scss\"; // TODO @SONIA\n\nclass TaskDetail extends Component {\n  constructor(props) {\n    super(props);\n\n    this.requestTaskData = async () => {\n      const taskId = this.props.match.params.id;\n\n      try {\n        const result = await reqTaskDetail(taskId);\n\n        if (result.status === 0) {\n          this.setState({\n            taskData: result.data\n          });\n        }\n      } catch (error) {\n        alert(\"failed to request task detail\");\n      }\n    };\n\n    this.state = {\n      taskData: {},\n      userRole: ''\n    };\n    this.rightPageRef = React.createRef();\n  }\n\n  async componentDidMount() {\n    await this.requestTaskData();\n    this.getUserRole();\n    this.rightPageRef.current.style.left = \"0px\";\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (JSON.stringify(prevProps) !== JSON.stringify(this.props)) {\n      await this.requestTaskData();\n      this.getUserRole();\n    }\n  }\n\n  getUserRole() {\n    const {\n      posterEmail,\n      offers\n    } = this.state.taskData;\n    const userEmail = this.props.user.email;\n\n    if (userEmail === posterEmail) {\n      this.setState({\n        userRole: \"poster\"\n      });\n    } else if (offers && offers.length !== 0 && offers[0].email === userEmail) {\n      this.setState({\n        userRole: \"assignee\"\n      });\n    } else {\n      this.setState({\n        userRole: \"\"\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"task-detail\",\n      ref: this.rightPageRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"task-detail__left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, React.createElement(LeftPanel, Object.assign({}, this.state, this.props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    })), React.createElement(OfferSection, Object.assign({}, this.state, this.props, {\n      updateTaskData: taskData => this.setState({\n        taskData\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    })), React.createElement(QuestionSection, Object.assign({}, this.state, this.props, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"task-detail__right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(SideBar, Object.assign({}, this.state, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default connect(state => ({\n  user: state.user\n}), {})(withRouter(TaskDetail));","map":{"version":3,"sources":["/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-right/task-detail/task-detail.js"],"names":["React","Component","withRouter","Link","connect","SideBar","LeftPanel","OfferSection","QuestionSection","reqTaskDetail","TaskDetail","constructor","props","requestTaskData","taskId","match","params","id","result","status","setState","taskData","data","error","alert","state","userRole","rightPageRef","createRef","componentDidMount","getUserRole","current","style","left","componentDidUpdate","prevProps","prevState","JSON","stringify","posterEmail","offers","userEmail","user","email","length","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport SideBar from \"./side-bar/side-bar\";\nimport LeftPanel from \"./left-panel/left-panel\";\nimport OfferSection from \"./offer-section/offer-section\";\nimport QuestionSection from \"./question-section/question-section\";\nimport { reqTaskDetail } from \"../../../../api/api\";\n\nimport \"./task-detail.scss\";\n\n// TODO @SONIA\nclass TaskDetail extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      taskData: {},\n      userRole: ''\n    };\n    this.rightPageRef = React.createRef();\n  }\n\n  async componentDidMount() {\n    await this.requestTaskData();\n    this.getUserRole();\n    this.rightPageRef.current.style.left = \"0px\";\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (JSON.stringify(prevProps) !== JSON.stringify(this.props)) {\n      await this.requestTaskData();\n      this.getUserRole();\n    }\n  }\n\n  requestTaskData = async () => {\n    const taskId = this.props.match.params.id;\n    try {\n      const result = await reqTaskDetail(taskId);\n      if (result.status === 0) {\n        this.setState({ taskData: result.data });\n      }\n    } catch (error) {\n      alert(\"failed to request task detail\");\n    }\n  }\n\n  getUserRole() {\n    const { posterEmail, offers } = this.state.taskData;\n    const userEmail = this.props.user.email;\n    if (userEmail === posterEmail) {\n      this.setState({ userRole: \"poster\" })\n    }\n    else if (offers && offers.length !== 0\n      && offers[0].email === userEmail) {\n      this.setState({ userRole: \"assignee\" })\n    } else {\n      this.setState({ userRole: \"\" })\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"task-detail\" ref={this.rightPageRef}>\n        <div className=\"task-detail__left\">\n          <LeftPanel {...this.state} {...this.props} />\n          <OfferSection {...this.state} {...this.props} updateTaskData={(taskData) => this.setState({ taskData })} />\n          {/* ======这里子传父很简单 redux麻烦 */}\n          <QuestionSection {...this.state} {...this.props}  />\n        </div>\n        <div className=\"task-detail__right\">\n          <SideBar {...this.state} />\n        </div>\n      </div >\n    );\n  }\n}\n\nexport default connect(state => ({ user: state.user }), {})(\n  withRouter(TaskDetail)\n);\n"]},"metadata":{},"sourceType":"module"}