{"ast":null,"code":"var _jsxFileName = \"/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-right/task-detail/side-bar/side-bar.js\";\nimport React from \"react\";\nimport \"./side-bar.scss\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSortDown } from \"@fortawesome/free-solid-svg-icons\";\nimport { addTaskDetail, addUserRole, clearTaskDetail, reloadTaskDetail } from \"../../../../../redux/actions\";\nimport { reqUpdateTask, reqTaskDetail } from \"../../../../../api/api\"; // TODO @SONIA\n\nclass SideBar extends React.Component {\n  constructor() {\n    super();\n\n    this.pushToGeneratedUrl = pathname => {\n      this.props.history.push(`${this.props.match.url}/${pathname}/${this.props.match.params[0]}-${this.props.match.params.id}`);\n    };\n\n    this.releasePayment = async () => {\n      const taskId = this.props.match.params.id;\n\n      try {\n        const result = await reqUpdateTask(taskId, {\n          status: 'completed'\n        });\n        const taskDetailResult = await reqTaskDetail(taskId);\n        this.props.addTaskDetail(taskDetailResult.data);\n      } catch (error) {\n        alert(\"failed to release payment\"); ///\n      }\n    };\n\n    this.requestPayment = async () => {\n      const taskId = this.props.match.params.id;\n\n      try {\n        const result = await reqUpdateTask(taskId, {\n          status: 'assigned-topay'\n        });\n        const taskDetailResult = await reqTaskDetail(taskId);\n        this.props.addTaskDetail(taskDetailResult.data);\n      } catch (error) {\n        alert(\"failed to request payment\"); ///\n      }\n    };\n\n    this.state = {\n      menuToggle: false\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (JSON.stringify(this.props) !== JSON.stringify(prevProps)) {\n      this.setState({\n        menuToggle: false\n      });\n    }\n  }\n\n  render() {\n    const {\n      taskData,\n      userRole\n    } = this.props.taskDetail;\n    const {\n      status\n    } = taskData && taskData.taskDetail;\n    const {\n      price,\n      offers\n    } = taskData && taskData.taskDetail;\n    return React.createElement(\"div\", {\n      className: \"side-bar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"side-bar__payment\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"payment__title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, \"TASK BUDGET\"), React.createElement(\"div\", {\n      className: \"payment__price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, \"$\"), React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, price)), userRole !== \"poster\" ? status === \"assigned\" && userRole === \"assignee\" && React.createElement(\"div\", {\n      className: \"green-button \",\n      onClick: this.requestPayment,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, \"Request Payment\") || status === \"assigned-topay\" && userRole === \"assignee\" && React.createElement(\"div\", {\n      className: \"green-button button--disabled\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, \"Awaiting Payment\") || status === \"assigned\" && React.createElement(\"div\", {\n      className: \"green-button button--disabled\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, \"Assigned\") || status === \"completed\" && userRole === \"assignee\" && React.createElement(\"div\", {\n      className: \"green-button\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \"Leave Review\") || status === \"completed\" && React.createElement(\"div\", {\n      className: \"green-button button--disabled\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, \"Completed\") || status === \"reviewed\" && React.createElement(\"div\", {\n      className: \"green-button button--disabled\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, \"Reviewed\") || status === \"open\" && offers && offers.find(offer => offer.email === this.props.user.email) && React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      className: \"side-bar__padder--blue\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"You offered $\", offers.find(offer => offer.email === this.props.user.email).price), React.createElement(\"div\", {\n      className: \"green-button\",\n      onClick: () => {\n        this.pushToGeneratedUrl('update-offer');\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"Update your offer\")) || status === \"open\" && React.createElement(\"div\", {\n      className: \"green-button\",\n      onClick: () => {\n        //如果没登陆的话自动跳转登陆\n        if (!this.props.user.email) {\n          this.props.history.push(`${this.props.match.url}/login`);\n        } else {\n          this.pushToGeneratedUrl('make-an-offer');\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \"Make an offer\") : status === \"open\" && React.createElement(\"div\", {\n      className: \"green-button\",\n      onClick: () => {\n        this.pushToGeneratedUrl('review-offers');\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, \"Review offers\") || status === \"assigned\" && React.createElement(\"div\", {\n      className: \"green-button\",\n      onClick: () => {\n        this.pushToGeneratedUrl('private-message');\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, \"Private Message\") || status === \"assigned-topay\" && React.createElement(\"div\", {\n      className: \"green-button\",\n      onClick: () => {\n        this.releasePayment();\n        this.pushToGeneratedUrl('release-payment');\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, \"Release Payment\") || status === \"completed\" && React.createElement(\"div\", {\n      className: \"green-button\",\n      onClick: () => {\n        this.pushToGeneratedUrl('leave-a-review');\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Leave Review\") || status === \"reviewed\" && React.createElement(\"div\", {\n      className: \"green-button button--disabled\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"Reviewed\")), React.createElement(\"div\", {\n      className: \"more-options__header\",\n      onClick: () => {\n        this.setState({\n          menuToggle: !this.state.menuToggle\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \"More Options\"), React.createElement(FontAwesomeIcon, {\n      icon: faSortDown,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    })), this.state.menuToggle && React.createElement(\"div\", {\n      className: \"more-options__dropdown-menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, userRole === \"poster\" && React.createElement(\"div\", {\n      className: \"option\",\n      onClick: () => {\n        //TODO: 如果没登录的话先post/edit然后最后提示登录，登录成功后再跳转\n        if (!this.props.user.email) {\n          this.props.history.push(`${this.props.match.url}/login`);\n        } else {\n          this.pushToGeneratedUrl('edit');\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"Edit Task\"), React.createElement(\"div\", {\n      className: \"option\",\n      onClick: () => {\n        //TODO: 如果没登录的话先post/edit然后最后提示登录，登录成功后再跳转\n        if (!this.props.user.email) {\n          this.props.history.push(`${this.props.match.url}/login`);\n        } else {\n          this.pushToGeneratedUrl('post-similar');\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Post a Similar Task\"), React.createElement(\"div\", {\n      className: \"option\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, \"Set up Alerts\"), taskData.status === \"open\" && userRole === \"poster\" && React.createElement(\"div\", {\n      className: \"option\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }, \"Cancel Task\")));\n  }\n\n}\n\nexport default connect(state => ({\n  user: state.user,\n  taskDetail: state.taskDetail\n}), {\n  addUserRole,\n  addTaskDetail\n})(withRouter(SideBar));","map":{"version":3,"sources":["/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-right/task-detail/side-bar/side-bar.js"],"names":["React","withRouter","connect","FontAwesomeIcon","faSortDown","addTaskDetail","addUserRole","clearTaskDetail","reloadTaskDetail","reqUpdateTask","reqTaskDetail","SideBar","Component","constructor","pushToGeneratedUrl","pathname","props","history","push","match","url","params","id","releasePayment","taskId","result","status","taskDetailResult","data","error","alert","requestPayment","state","menuToggle","componentDidUpdate","prevProps","prevState","JSON","stringify","setState","render","taskData","userRole","taskDetail","price","offers","find","offer","email","user"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./side-bar.scss\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { faSortDown } from \"@fortawesome/free-solid-svg-icons\";\nimport { addTaskDetail, addUserRole, clearTaskDetail, reloadTaskDetail } from \"../../../../../redux/actions\"\nimport { reqUpdateTask, reqTaskDetail } from \"../../../../../api/api\"\n// TODO @SONIA\n\nclass SideBar extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      menuToggle: false\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (JSON.stringify(this.props) !== JSON.stringify(prevProps)) {\n      this.setState({ menuToggle: false })\n    }\n  }\n\n  pushToGeneratedUrl = (pathname) => {\n    this.props.history.push(\n      `${this.props.match.url}/${pathname}/${this.props.match.params[0]}-${this.props.match.params.id}`\n    );\n  }\n\n  releasePayment = async () => {\n    const taskId = this.props.match.params.id;\n    try {\n      const result = await reqUpdateTask(taskId, { status: 'completed' });\n      const taskDetailResult = await reqTaskDetail(taskId);\n      this.props.addTaskDetail(taskDetailResult.data)\n    } catch (error) {\n      alert(\"failed to release payment\");///\n    }\n  }\n\n  requestPayment = async () => {\n    const taskId = this.props.match.params.id;\n    try {\n      const result = await reqUpdateTask(taskId, { status: 'assigned-topay' });\n      const taskDetailResult = await reqTaskDetail(taskId);\n      this.props.addTaskDetail(taskDetailResult.data)\n    } catch (error) {\n      alert(\"failed to request payment\");///\n    }\n  }\n\n\n  render() {\n    const { taskData, userRole } = this.props.taskDetail;\n    const { status } = taskData && taskData.taskDetail;\n    const { price, offers } = taskData && taskData.taskDetail;\n    return (\n      <div className=\"side-bar\">\n        <div className=\"side-bar__payment\">\n          <div className=\"payment__title\">TASK BUDGET</div>\n          <div className=\"payment__price\">\n            <h2>$</h2>\n            <h2>{price}</h2>\n          </div>\n          {userRole !== \"poster\"\n            ?\n            (\n              (status === \"assigned\" && userRole === \"assignee\"\n                &&\n                <div className=\"green-button \" onClick={this.requestPayment}>Request Payment</div>\n              ) ||\n              (status === \"assigned-topay\" && userRole === \"assignee\"\n                &&\n                <div className=\"green-button button--disabled\">Awaiting Payment</div>\n              )\n              ||\n              (status === \"assigned\"\n                &&\n                <div className=\"green-button button--disabled\">Assigned</div>\n              ) ||\n              (status === \"completed\" && userRole === \"assignee\"\n                &&\n                <div className=\"green-button\">Leave Review</div>\n              ) ||\n              (status === \"completed\"\n                &&\n                <div className=\"green-button button--disabled\">Completed</div>\n              ) ||\n              (status === \"reviewed\"\n                &&\n                <div className=\"green-button button--disabled\">Reviewed</div>\n              ) ||\n              (status === \"open\" && (offers && offers.find(offer => offer.email === this.props.user.email))\n                &&\n                <>\n                  <div className=\"side-bar__padder--blue\">You offered ${offers.find(offer => offer.email === this.props.user.email).price}</div>\n                  <div className=\"green-button\" onClick={() => {\n                    this.pushToGeneratedUrl('update-offer')\n                  }}>\n                    Update your offer\n                  </div>\n                </>\n              ) ||\n              (status === \"open\"\n                &&\n                <div className=\"green-button\" onClick={() => {\n                  //如果没登陆的话自动跳转登陆\n                  if (!this.props.user.email) {\n                    this.props.history.push(`${this.props.match.url}/login`);\n                  } else {\n                    this.pushToGeneratedUrl('make-an-offer')\n                  }\n                }}>\n                  Make an offer\n                </div>\n              )\n            )\n            :\n            (status === \"open\"\n              &&\n              <div className=\"green-button\" onClick={() => {\n                this.pushToGeneratedUrl('review-offers')\n              }}>\n                Review offers\n                </div>\n            ) ||\n            (status === \"assigned\"\n              &&\n              <div className=\"green-button\" onClick={() => {\n                this.pushToGeneratedUrl('private-message')\n              }}>\n                Private Message\n              </div>\n            ) ||\n            (status === \"assigned-topay\"\n              &&\n              <div className=\"green-button\" onClick={() => {\n                this.releasePayment();\n                this.pushToGeneratedUrl('release-payment')\n              }}>\n                Release Payment\n              </div>\n            ) ||\n            (status === \"completed\"\n              &&\n              <div className=\"green-button\" onClick={() => {\n                this.pushToGeneratedUrl('leave-a-review')\n              }}>\n                Leave Review\n              </div>\n            ) ||\n            (status === \"reviewed\"\n              &&\n              <div className=\"green-button button--disabled\">Reviewed</div>\n            )\n\n          }\n        </div>\n\n\n        <div className=\"more-options__header\" onClick={() => { this.setState({ menuToggle: !this.state.menuToggle }) }}>\n          <span>\n            More Options\n          </span>\n          <FontAwesomeIcon icon={faSortDown} />\n        </div>\n\n        {this.state.menuToggle && (\n          <div className=\"more-options__dropdown-menu\">\n            {userRole === \"poster\" && <div className=\"option\" onClick={() => {\n              //TODO: 如果没登录的话先post/edit然后最后提示登录，登录成功后再跳转\n              if (!this.props.user.email) {\n                this.props.history.push(`${this.props.match.url}/login`);\n              } else {\n                this.pushToGeneratedUrl('edit')\n              }\n            }}>\n              Edit Task\n            </div>\n            }\n\n            <div className=\"option\" onClick={() => {\n              //TODO: 如果没登录的话先post/edit然后最后提示登录，登录成功后再跳转\n              if (!this.props.user.email) {\n                this.props.history.push(`${this.props.match.url}/login`);\n              } else {\n                this.pushToGeneratedUrl('post-similar')\n              }\n            }}>\n              Post a Similar Task\n            </div>\n\n            <div className=\"option\">Set up Alerts</div>\n\n            {taskData.status === \"open\" && userRole === \"poster\"\n              &&\n              <div className=\"option\">Cancel Task</div>\n            }\n          </div>\n        )\n        }\n      </div>\n\n    );\n  }\n}\nexport default connect(state => ({ user: state.user, taskDetail: state.taskDetail }), { addUserRole, addTaskDetail })(\n  withRouter(SideBar)\n);\n"]},"metadata":{},"sourceType":"module"}