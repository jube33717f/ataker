{"ast":null,"code":"/*!\n * cookies\n * Copyright(c) 2014 Jed Schmidt, http://jed.is/\n * Copyright(c) 2015-2016 Douglas Christopher Wilson\n * MIT Licensed\n */\n'use strict';\n\nvar deprecate = require('depd')('cookies');\n\nvar Keygrip = require('keygrip');\n\nvar http = require('http');\n\nvar cache = {};\n/**\n * RegExp to match field-content in RFC 7230 sec 3.2\n *\n * field-content = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n * field-vchar   = VCHAR / obs-text\n * obs-text      = %x80-FF\n */\n\nvar fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;\n/**\n * RegExp to match Same-Site cookie attribute value.\n */\n\nvar SAME_SITE_REGEXP = /^(?:lax|none|strict)$/i;\n\nfunction Cookies(request, response, options) {\n  if (!(this instanceof Cookies)) return new Cookies(request, response, options);\n  this.secure = undefined;\n  this.request = request;\n  this.response = response;\n\n  if (options) {\n    if (Array.isArray(options)) {\n      // array of key strings\n      deprecate('\"keys\" argument; provide using options {\"keys\": [...]}');\n      this.keys = new Keygrip(options);\n    } else if (options.constructor && options.constructor.name === 'Keygrip') {\n      // any keygrip constructor to allow different versions\n      deprecate('\"keys\" argument; provide using options {\"keys\": keygrip}');\n      this.keys = options;\n    } else {\n      this.keys = Array.isArray(options.keys) ? new Keygrip(options.keys) : options.keys;\n      this.secure = options.secure;\n    }\n  }\n}\n\nCookies.prototype.get = function (name, opts) {\n  var sigName = name + \".sig\",\n      header,\n      match,\n      value,\n      remote,\n      data,\n      index,\n      signed = opts && opts.signed !== undefined ? opts.signed : !!this.keys;\n  header = this.request.headers[\"cookie\"];\n  if (!header) return;\n  match = header.match(getPattern(name));\n  if (!match) return;\n  value = match[1];\n  if (!opts || !signed) return value;\n  remote = this.get(sigName);\n  if (!remote) return;\n  data = name + \"=\" + value;\n  if (!this.keys) throw new Error('.keys required for signed cookies');\n  index = this.keys.index(data, remote);\n\n  if (index < 0) {\n    this.set(sigName, null, {\n      path: \"/\",\n      signed: false\n    });\n  } else {\n    index && this.set(sigName, this.keys.sign(data), {\n      signed: false\n    });\n    return value;\n  }\n};\n\nCookies.prototype.set = function (name, value, opts) {\n  var res = this.response,\n      req = this.request,\n      headers = res.getHeader(\"Set-Cookie\") || [],\n      secure = this.secure !== undefined ? !!this.secure : req.protocol === 'https' || req.connection.encrypted,\n      cookie = new Cookie(name, value, opts),\n      signed = opts && opts.signed !== undefined ? opts.signed : !!this.keys;\n  if (typeof headers == \"string\") headers = [headers];\n\n  if (!secure && opts && opts.secure) {\n    throw new Error('Cannot send secure cookie over unencrypted connection');\n  }\n\n  cookie.secure = opts && opts.secure !== undefined ? opts.secure : secure;\n\n  if (opts && \"secureProxy\" in opts) {\n    deprecate('\"secureProxy\" option; use \"secure\" option, provide \"secure\" to constructor if needed');\n    cookie.secure = opts.secureProxy;\n  }\n\n  pushCookie(headers, cookie);\n\n  if (opts && signed) {\n    if (!this.keys) throw new Error('.keys required for signed cookies');\n    cookie.value = this.keys.sign(cookie.toString());\n    cookie.name += \".sig\";\n    pushCookie(headers, cookie);\n  }\n\n  var setHeader = res.set ? http.OutgoingMessage.prototype.setHeader : res.setHeader;\n  setHeader.call(res, 'Set-Cookie', headers);\n  return this;\n};\n\nfunction Cookie(name, value, attrs) {\n  if (!fieldContentRegExp.test(name)) {\n    throw new TypeError('argument name is invalid');\n  }\n\n  if (value && !fieldContentRegExp.test(value)) {\n    throw new TypeError('argument value is invalid');\n  }\n\n  this.name = name;\n  this.value = value || \"\";\n\n  for (var name in attrs) {\n    this[name] = attrs[name];\n  }\n\n  if (!this.value) {\n    this.expires = new Date(0);\n    this.maxAge = null;\n  }\n\n  if (this.path && !fieldContentRegExp.test(this.path)) {\n    throw new TypeError('option path is invalid');\n  }\n\n  if (this.domain && !fieldContentRegExp.test(this.domain)) {\n    throw new TypeError('option domain is invalid');\n  }\n\n  if (this.sameSite && this.sameSite !== true && !SAME_SITE_REGEXP.test(this.sameSite)) {\n    throw new TypeError('option sameSite is invalid');\n  }\n}\n\nCookie.prototype.path = \"/\";\nCookie.prototype.expires = undefined;\nCookie.prototype.domain = undefined;\nCookie.prototype.httpOnly = true;\nCookie.prototype.sameSite = false;\nCookie.prototype.secure = false;\nCookie.prototype.overwrite = false;\n\nCookie.prototype.toString = function () {\n  return this.name + \"=\" + this.value;\n};\n\nCookie.prototype.toHeader = function () {\n  var header = this.toString();\n  if (this.maxAge) this.expires = new Date(Date.now() + this.maxAge);\n  if (this.path) header += \"; path=\" + this.path;\n  if (this.expires) header += \"; expires=\" + this.expires.toUTCString();\n  if (this.domain) header += \"; domain=\" + this.domain;\n  if (this.sameSite) header += \"; samesite=\" + (this.sameSite === true ? 'strict' : this.sameSite.toLowerCase());\n  if (this.secure) header += \"; secure\";\n  if (this.httpOnly) header += \"; httponly\";\n  return header;\n}; // back-compat so maxage mirrors maxAge\n\n\nObject.defineProperty(Cookie.prototype, 'maxage', {\n  configurable: true,\n  enumerable: true,\n  get: function () {\n    return this.maxAge;\n  },\n  set: function (val) {\n    return this.maxAge = val;\n  }\n});\ndeprecate.property(Cookie.prototype, 'maxage', '\"maxage\"; use \"maxAge\" instead');\n\nfunction getPattern(name) {\n  if (cache[name]) return cache[name];\n  return cache[name] = new RegExp(\"(?:^|;) *\" + name.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\") + \"=([^;]*)\");\n}\n\nfunction pushCookie(headers, cookie) {\n  if (cookie.overwrite) {\n    for (var i = headers.length - 1; i >= 0; i--) {\n      if (headers[i].indexOf(cookie.name + '=') === 0) {\n        headers.splice(i, 1);\n      }\n    }\n  }\n\n  headers.push(cookie.toHeader());\n}\n\nCookies.connect = Cookies.express = function (keys) {\n  return function (req, res, next) {\n    req.cookies = res.cookies = new Cookies(req, res, {\n      keys: keys\n    });\n    next();\n  };\n};\n\nCookies.Cookie = Cookie;\nmodule.exports = Cookies;","map":{"version":3,"sources":["/Users/jubi/fullStack/groupProject/0322/xyz.frontend/node_modules/cookies/index.js"],"names":["deprecate","require","Keygrip","http","cache","fieldContentRegExp","SAME_SITE_REGEXP","Cookies","request","response","options","secure","undefined","Array","isArray","keys","constructor","name","prototype","get","opts","sigName","header","match","value","remote","data","index","signed","headers","getPattern","Error","set","path","sign","res","req","getHeader","protocol","connection","encrypted","cookie","Cookie","secureProxy","pushCookie","toString","setHeader","OutgoingMessage","call","attrs","test","TypeError","expires","Date","maxAge","domain","sameSite","httpOnly","overwrite","toHeader","now","toUTCString","toLowerCase","Object","defineProperty","configurable","enumerable","val","property","RegExp","replace","i","length","indexOf","splice","push","connect","express","next","cookies","module","exports"],"mappings":"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","sourcesContent":["/*!\n * cookies\n * Copyright(c) 2014 Jed Schmidt, http://jed.is/\n * Copyright(c) 2015-2016 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\nvar deprecate = require('depd')('cookies')\nvar Keygrip = require('keygrip')\nvar http = require('http')\nvar cache = {}\n\n/**\n * RegExp to match field-content in RFC 7230 sec 3.2\n *\n * field-content = field-vchar [ 1*( SP / HTAB ) field-vchar ]\n * field-vchar   = VCHAR / obs-text\n * obs-text      = %x80-FF\n */\n\nvar fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;\n\n/**\n * RegExp to match Same-Site cookie attribute value.\n */\n\nvar SAME_SITE_REGEXP = /^(?:lax|none|strict)$/i\n\nfunction Cookies(request, response, options) {\n  if (!(this instanceof Cookies)) return new Cookies(request, response, options)\n\n  this.secure = undefined\n  this.request = request\n  this.response = response\n\n  if (options) {\n    if (Array.isArray(options)) {\n      // array of key strings\n      deprecate('\"keys\" argument; provide using options {\"keys\": [...]}')\n      this.keys = new Keygrip(options)\n    } else if (options.constructor && options.constructor.name === 'Keygrip') {\n      // any keygrip constructor to allow different versions\n      deprecate('\"keys\" argument; provide using options {\"keys\": keygrip}')\n      this.keys = options\n    } else {\n      this.keys = Array.isArray(options.keys) ? new Keygrip(options.keys) : options.keys\n      this.secure = options.secure\n    }\n  }\n}\n\nCookies.prototype.get = function(name, opts) {\n  var sigName = name + \".sig\"\n    , header, match, value, remote, data, index\n    , signed = opts && opts.signed !== undefined ? opts.signed : !!this.keys\n\n  header = this.request.headers[\"cookie\"]\n  if (!header) return\n\n  match = header.match(getPattern(name))\n  if (!match) return\n\n  value = match[1]\n  if (!opts || !signed) return value\n\n  remote = this.get(sigName)\n  if (!remote) return\n\n  data = name + \"=\" + value\n  if (!this.keys) throw new Error('.keys required for signed cookies');\n  index = this.keys.index(data, remote)\n\n  if (index < 0) {\n    this.set(sigName, null, {path: \"/\", signed: false })\n  } else {\n    index && this.set(sigName, this.keys.sign(data), { signed: false })\n    return value\n  }\n};\n\nCookies.prototype.set = function(name, value, opts) {\n  var res = this.response\n    , req = this.request\n    , headers = res.getHeader(\"Set-Cookie\") || []\n    , secure = this.secure !== undefined ? !!this.secure : req.protocol === 'https' || req.connection.encrypted\n    , cookie = new Cookie(name, value, opts)\n    , signed = opts && opts.signed !== undefined ? opts.signed : !!this.keys\n\n  if (typeof headers == \"string\") headers = [headers]\n\n  if (!secure && opts && opts.secure) {\n    throw new Error('Cannot send secure cookie over unencrypted connection')\n  }\n\n  cookie.secure = opts && opts.secure !== undefined\n    ? opts.secure\n    : secure\n\n  if (opts && \"secureProxy\" in opts) {\n    deprecate('\"secureProxy\" option; use \"secure\" option, provide \"secure\" to constructor if needed')\n    cookie.secure = opts.secureProxy\n  }\n\n  pushCookie(headers, cookie)\n\n  if (opts && signed) {\n    if (!this.keys) throw new Error('.keys required for signed cookies');\n    cookie.value = this.keys.sign(cookie.toString())\n    cookie.name += \".sig\"\n    pushCookie(headers, cookie)\n  }\n\n  var setHeader = res.set ? http.OutgoingMessage.prototype.setHeader : res.setHeader\n  setHeader.call(res, 'Set-Cookie', headers)\n  return this\n};\n\nfunction Cookie(name, value, attrs) {\n  if (!fieldContentRegExp.test(name)) {\n    throw new TypeError('argument name is invalid');\n  }\n\n  if (value && !fieldContentRegExp.test(value)) {\n    throw new TypeError('argument value is invalid');\n  }\n\n  this.name = name\n  this.value = value || \"\"\n\n  for (var name in attrs) {\n    this[name] = attrs[name]\n  }\n\n  if (!this.value) {\n    this.expires = new Date(0)\n    this.maxAge = null\n  }\n\n  if (this.path && !fieldContentRegExp.test(this.path)) {\n    throw new TypeError('option path is invalid');\n  }\n\n  if (this.domain && !fieldContentRegExp.test(this.domain)) {\n    throw new TypeError('option domain is invalid');\n  }\n\n  if (this.sameSite && this.sameSite !== true && !SAME_SITE_REGEXP.test(this.sameSite)) {\n    throw new TypeError('option sameSite is invalid')\n  }\n}\n\nCookie.prototype.path = \"/\";\nCookie.prototype.expires = undefined;\nCookie.prototype.domain = undefined;\nCookie.prototype.httpOnly = true;\nCookie.prototype.sameSite = false;\nCookie.prototype.secure = false;\nCookie.prototype.overwrite = false;\n\nCookie.prototype.toString = function() {\n  return this.name + \"=\" + this.value\n};\n\nCookie.prototype.toHeader = function() {\n  var header = this.toString()\n\n  if (this.maxAge) this.expires = new Date(Date.now() + this.maxAge);\n\n  if (this.path     ) header += \"; path=\" + this.path\n  if (this.expires  ) header += \"; expires=\" + this.expires.toUTCString()\n  if (this.domain   ) header += \"; domain=\" + this.domain\n  if (this.sameSite ) header += \"; samesite=\" + (this.sameSite === true ? 'strict' : this.sameSite.toLowerCase())\n  if (this.secure   ) header += \"; secure\"\n  if (this.httpOnly ) header += \"; httponly\"\n\n  return header\n};\n\n// back-compat so maxage mirrors maxAge\nObject.defineProperty(Cookie.prototype, 'maxage', {\n  configurable: true,\n  enumerable: true,\n  get: function () { return this.maxAge },\n  set: function (val) { return this.maxAge = val }\n});\ndeprecate.property(Cookie.prototype, 'maxage', '\"maxage\"; use \"maxAge\" instead')\n\nfunction getPattern(name) {\n  if (cache[name]) return cache[name]\n\n  return cache[name] = new RegExp(\n    \"(?:^|;) *\" +\n    name.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\") +\n    \"=([^;]*)\"\n  )\n}\n\nfunction pushCookie(headers, cookie) {\n  if (cookie.overwrite) {\n    for (var i = headers.length - 1; i >= 0; i--) {\n      if (headers[i].indexOf(cookie.name + '=') === 0) {\n        headers.splice(i, 1)\n      }\n    }\n  }\n\n  headers.push(cookie.toHeader())\n}\n\nCookies.connect = Cookies.express = function(keys) {\n  return function(req, res, next) {\n    req.cookies = res.cookies = new Cookies(req, res, {\n      keys: keys\n    })\n\n    next()\n  }\n}\n\nCookies.Cookie = Cookie\n\nmodule.exports = Cookies\n"]},"metadata":{},"sourceType":"script"}