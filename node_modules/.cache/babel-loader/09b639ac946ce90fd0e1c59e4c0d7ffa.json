{"ast":null,"code":"var _jsxFileName = \"/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-right/task-detail/offer-section/offer-section.js\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport ToggleTextbox from \"../../../../../components/toggle-textbox/toggle-textbox\";\nimport JobOffer from \"../../../../../assets/job-offer.svg\";\nimport { get_time_diff } from \"../../../../../utils/time-difference\";\nimport { reqUpdateTask } from \"../../../../../api/api\"; // TODO @SONIA\n\nclass OfferSection extends React.Component {\n  constructor() {\n    super();\n\n    this.acceptOffer = async offer => {\n      const taskId = this.props.match.params.id;\n\n      try {\n        const result = await reqUpdateTask(taskId, { ...this.props.taskData,\n          status: 'assigned',\n          offers: [offer]\n        }); //accept offer时改变task.status，并在task.offers里删除除assignee之外的所有offer\n\n        if (result.status === 0) {\n          // reqUpdateTask returns updated task info\n          this.props.updateTaskData(result.data);\n        }\n      } catch (error) {\n        alert(\"failed to request task detail\");\n      }\n    };\n  }\n\n  render() {\n    const userEmail = this.props.user.email;\n    const {\n      status,\n      offers\n    } = this.props.taskData;\n    const {\n      userRole\n    } = this.props;\n    return React.createElement(\"div\", {\n      className: \"task-detail__offer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"splitter-section-name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 33\n      },\n      __self: this\n    }, status === 'open' ? 'Offers' : 'Assignee'), offers && offers.length !== 0 ? offers.map(offer => offer.messages.map((message, index) => index === 0 ? React.createElement(\"div\", {\n      className: \"task-detail__offer--offerer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    }, React.createElement(ToggleTextbox, {\n      message: message,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }), userRole === \"poster\" && React.createElement(React.Fragment, null, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46\n      },\n      __self: this\n    }, \"$\", offer.price), React.createElement(\"div\", {\n      className: `green-button ${status !== \"open\" && 'button--disabled'} `,\n      onClick: () => {\n        this.acceptOffer(offer);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }, status === \"open\" ? 'Accept' : 'Accepted'))) : React.createElement(\"div\", {\n      className: \"task-detail__offer--reply\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"avatar-image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: message.photo,\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"poster-detail__item--detail\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"user-name-holder\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"\",\n      className: \"user-name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, message.username)), message.messageContent, React.createElement(\"div\", {\n      className: \"toggle-textbox__message--bottom\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, get_time_diff(message.postDate), \" ago\"), userEmail && React.createElement(Link, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, \"Reply\")))))) : React.createElement(\"div\", {\n      className: \"task-detail__offer--no-offer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: JobOffer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"green-button\",\n      onClick: () => {\n        //如果没登陆的话自动跳转登陆\n        if (!userEmail) {\n          this.props.history.push(`${this.props.match.url}/login`);\n        } else {\n          this.props.history.push(`${this.props.match.url}/make-an-offer/${this.props.match.params[0]}-${this.props.match.params.id}`);\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, \"Make an offer\")));\n  }\n\n}\n\nexport default OfferSection;","map":{"version":3,"sources":["/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-right/task-detail/offer-section/offer-section.js"],"names":["React","Link","ToggleTextbox","get_time_diff","reqUpdateTask","OfferSection","Component","constructor","acceptOffer","offer","taskId","props","match","params","id","result","taskData","status","offers","updateTaskData","data","error","alert","render","userEmail","user","email","userRole","length","map","messages","message","index","price","photo","username","messageContent","postDate","JobOffer","history","push","url"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport ToggleTextbox from \"../../../../../components/toggle-textbox/toggle-textbox\";\nimport JobOffer from \"../../../../../assets/job-offer.svg\";\nimport { get_time_diff } from \"../../../../../utils/time-difference\";\nimport { reqUpdateTask } from \"../../../../../api/api\";\n\n// TODO @SONIA\n\nclass OfferSection extends React.Component {\n    constructor() {\n        super();\n    }\n\n    acceptOffer = async (offer) => {\n        const taskId = this.props.match.params.id;\n        try {\n            const result = await reqUpdateTask(taskId, { ...this.props.taskData, status: 'assigned', offers: [offer] }); //accept offer时改变task.status，并在task.offers里删除除assignee之外的所有offer\n            if (result.status === 0) {\n                // reqUpdateTask returns updated task info\n                this.props.updateTaskData(result.data);\n            }\n        } catch (error) {\n            alert(\"failed to request task detail\");\n        }\n    }\n\n    render() {\n        const userEmail = this.props.user.email;\n        const { status, offers } = this.props.taskData;\n        const { userRole } = this.props;\n        return (<div className=\"task-detail__offer\">\n            <div className=\"splitter-section-name\">\n                {status === 'open' ? 'Offers' : 'Assignee'}\n            </div>\n            {/* 这里默认如果assign task后，offers里面就只有assignee的offer */}\n            {offers && offers.length !== 0\n                ?\n                offers.map((offer) =>\n                    offer.messages.map((message, index) =>\n                        index === 0\n                            ?\n                            <div className=\"task-detail__offer--offerer\">\n                                <ToggleTextbox message={message} />\n                                {userRole === \"poster\" && <>\n                                    <h3>\n                                        ${offer.price}\n                                    </h3>\n                                    <div className={`green-button ${status !== \"open\" && 'button--disabled'} `} onClick={() => { this.acceptOffer(offer) }}>\n                                        {status === \"open\" ? 'Accept' : 'Accepted'}\n                                    </div></>}\n                            </div>\n                            :\n                            <div className=\"task-detail__offer--reply\">\n                                <div className=\"avatar-image\">\n                                    <img src={message.photo} alt=\"\" />\n                                </div>\n                                <div className=\"poster-detail__item--detail\">\n                                    <div className=\"user-name-holder\">\n                                        <a href=\"\" className=\"user-name\">\n                                            {message.username}\n                                        </a>\n                                    </div>\n                                    {message.messageContent}\n\n                                    <div className=\"toggle-textbox__message--bottom\"><span>{get_time_diff(message.postDate)} ago</span>\n                                        {userEmail && <Link>Reply</Link>}\n                                    </div>\n                                </div>\n\n                            </div>\n                    )\n                )\n                :\n                <div className=\"task-detail__offer--no-offer\">\n                    <img src={JobOffer} ></img>\n                    <div className=\"green-button\" onClick={() => {\n                        //如果没登陆的话自动跳转登陆\n                        if (!userEmail) {\n                            this.props.history.push(`${this.props.match.url}/login`);\n                        } else {\n                            this.props.history.push(\n                                `${this.props.match.url}/make-an-offer/${this.props.match.params[0]}-${this.props.match.params.id}`\n                            );\n                        }\n\n                    }}>Make an offer</div>\n                </div>\n            }\n        </div>\n        );\n    }\n}\nexport default OfferSection"]},"metadata":{},"sourceType":"module"}