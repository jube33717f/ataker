{"ast":null,"code":"var _jsxFileName = \"/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-right/task-detail/task-detail.js\";\nimport React, { Component } from \"react\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport SideBar from \"./side-bar/side-bar\";\nimport LeftPanel from \"./left-panel/left-panel\";\nimport OfferSection from \"./offer-section/offer-section\";\nimport QuestionSection from \"./question-section/question-section\";\nimport { reqTaskDetail } from \"../../../../api/api\";\nimport { addTaskDetail, addUserRole, clearTaskDetail, reloadTaskDetail } from \"../../../../redux/actions\";\nimport \"./task-detail.scss\"; // TODO @SONIA\n\nclass TaskDetail extends Component {\n  constructor(props) {\n    super(props);\n\n    this.requestTaskData = async () => {\n      let taskId = this.props.match.params.id;\n\n      try {\n        const result = await reqTaskDetail(taskId);\n\n        if (result.status === 200) {\n          this.props.addTaskDetail(result.data);\n        }\n      } catch (error) {// alert(\"failed to request task detail\");\n      }\n    };\n\n    this.rightPageRef = React.createRef();\n  }\n\n  async componentDidMount() {\n    await this.requestTaskData();\n    this.getUserRole();\n    this.rightPageRef.current.style.left = \"0px\";\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (!this.props.location.pathname.includes('reply-')) {\n      const taskId = this.props.match.params.id;\n\n      if (prevProps.match.params.id !== this.props.match.params.id) {\n        // || prevProps.taskDetail.taskData.taskDetail.id !== this.props.taskDetail.taskData.id) {\n        await this.requestTaskData();\n        this.getUserRole();\n      }\n\n      if (prevProps.user.email !== this.props.user.email) {\n        this.getUserRole();\n      }\n    }\n\n    if (this.props.taskDetail.readyToReload) {\n      await this.requestTaskData();\n      this.props.reloadTaskDetail(false);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.clearTaskDetail();\n  }\n\n  getUserRole() {\n    const posterEmail = this.props.taskDetail.taskData.taskDetail ? this.props.taskDetail.taskData.taskDetail.posterInfo.email : '';\n    const {\n      offers\n    } = this.props.taskDetail.taskData;\n    const userEmail = this.props.user.email;\n\n    if (userEmail === posterEmail) {\n      this.props.addUserRole(\"poster\");\n    } else if (offers && offers.length !== 0 && offers[0].email === userEmail) {\n      this.props.addUserRole(\"assignee\");\n    } else {\n      this.props.addUserRole(\"\");\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"task-detail\",\n      ref: this.rightPageRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"task-detail__left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(LeftPanel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }), React.createElement(OfferSection, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }), React.createElement(QuestionSection, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"task-detail__right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(SideBar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default connect(state => ({\n  user: state.user,\n  taskDetail: state.taskDetail\n}), {\n  addTaskDetail,\n  addUserRole,\n  clearTaskDetail,\n  reloadTaskDetail\n})(withRouter(TaskDetail));","map":{"version":3,"sources":["/Users/jubi/fullStack/groupProject/0322/xyz.frontend/src/pages/browse-tasks/browse-tasks-right/task-detail/task-detail.js"],"names":["React","Component","withRouter","Link","connect","SideBar","LeftPanel","OfferSection","QuestionSection","reqTaskDetail","addTaskDetail","addUserRole","clearTaskDetail","reloadTaskDetail","TaskDetail","constructor","props","requestTaskData","taskId","match","params","id","result","status","data","error","rightPageRef","createRef","componentDidMount","getUserRole","current","style","left","componentDidUpdate","prevProps","prevState","location","pathname","includes","user","email","taskDetail","readyToReload","componentWillUnmount","posterEmail","taskData","posterInfo","offers","userEmail","length","render","state"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport SideBar from \"./side-bar/side-bar\";\nimport LeftPanel from \"./left-panel/left-panel\";\nimport OfferSection from \"./offer-section/offer-section\";\nimport QuestionSection from \"./question-section/question-section\";\nimport { reqTaskDetail } from \"../../../../api/api\";\nimport { addTaskDetail, addUserRole, clearTaskDetail, reloadTaskDetail } from \"../../../../redux/actions\"\nimport \"./task-detail.scss\";\n\n// TODO @SONIA\nclass TaskDetail extends Component {\n  constructor(props) {\n    super(props);\n    this.rightPageRef = React.createRef();\n  }\n\n  async componentDidMount() {\n    await this.requestTaskData();\n    this.getUserRole();\n    this.rightPageRef.current.style.left = \"0px\";\n  }\n\n  async componentDidUpdate(prevProps, prevState) {\n    if (!this.props.location.pathname.includes('reply-')) {\n\n      const taskId = this.props.match.params.id;\n      if (prevProps.match.params.id !== this.props.match.params.id) {\n        // || prevProps.taskDetail.taskData.taskDetail.id !== this.props.taskDetail.taskData.id) {\n        await this.requestTaskData();\n        this.getUserRole();\n      }\n      if (prevProps.user.email !== this.props.user.email) {\n        this.getUserRole();\n      }\n\n    }\n    if (this.props.taskDetail.readyToReload) {\n      await this.requestTaskData();\n      this.props.reloadTaskDetail(false)\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.clearTaskDetail();\n  }\n\n  requestTaskData = async () => {\n\n    let taskId = this.props.match.params.id;\n\n    try {\n      const result = await reqTaskDetail(taskId);\n      if (result.status === 200) {\n        this.props.addTaskDetail(result.data)\n      }\n    } catch (error) {\n\n      // alert(\"failed to request task detail\");\n    }\n\n\n\n  }\n\n  getUserRole() {\n    const posterEmail = this.props.taskDetail.taskData.taskDetail ? this.props.taskDetail.taskData.taskDetail.posterInfo.email : '';\n    const { offers } = this.props.taskDetail.taskData;\n    const userEmail = this.props.user.email;\n    if (userEmail === posterEmail) {\n      this.props.addUserRole(\"poster\")\n    }\n    else if (offers && offers.length !== 0 && offers[0].email === userEmail) {\n      this.props.addUserRole(\"assignee\")\n    } else {\n      this.props.addUserRole(\"\")\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"task-detail\" ref={this.rightPageRef}>\n        <div className=\"task-detail__left\">\n          <LeftPanel />\n          <OfferSection />\n          <QuestionSection />\n        </div>\n        <div className=\"task-detail__right\">\n          <SideBar />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default connect(state => ({ user: state.user, taskDetail: state.taskDetail }), { addTaskDetail, addUserRole, clearTaskDetail, reloadTaskDetail })(\n  withRouter(TaskDetail)\n);\n"]},"metadata":{},"sourceType":"module"}